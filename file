if pd.isna(val_sf) != pd.isna(val_vt) or (
    not pd.isna(val_sf) and not pd.isna(val_vt) and
    str(val_sf).strip().casefold() != str(val_vt).strip().casefold()
):
    mismatches.append({
        "ViewName": view_name,
        "ColumnName": col,
        "ValueInVertica": format_value(val_vt)[:255] if val_vt is not None else "",
        "ValueInSnowflake": format_value(val_sf)[:255] if val_sf is not None else "",
        "Key": row_keys
    })