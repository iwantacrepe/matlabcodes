def compare_column_names(sf_columns, vertica_columns):
    # Create dicts for original case mapping
    sf_map = {col.lower(): col for col in sf_columns}
    vt_map = {col.lower(): col for col in vertica_columns}

    sf_set = set(sf_map.keys())
    vertica_set = set(vt_map.keys())

    only_in_sf_keys = sf_set - vertica_set
    only_in_vertica_keys = vertica_set - sf_set
    common_keys = sf_set & vertica_set

    return {
        'snowflake_columns': [sf_map[k] for k in sf_set],
        'vertica_columns': [vt_map[k] for k in vertica_set],
        'only_in_snowflake': [sf_map[k] for k in only_in_sf_keys],
        'only_in_vertica': [vt_map[k] for k in only_in_vertica_keys],
        'common_columns': [sf_map[k] for k in common_keys],
        'match_count': len(common_keys),
        'mismatch_count': len(only_in_sf_keys) + len(only_in_vertica_keys),
        'all_columns_match': len(only_in_sf_keys) == 0 and len(only_in_vertica_keys) == 0
    }