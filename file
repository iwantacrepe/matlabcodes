sf_cols = get_columns(sf_conn, table, dbtype="snowflake")
vt_cols = get_columns(vt_conn, table, dbtype="vertica")

# CASE-INSENSITIVE column mapping
sf_norm_map = {col.casefold(): col for col in sf_cols}
vt_norm_map = {col.casefold(): col for col in vt_cols}
common_norm = set(sf_norm_map.keys()) & set(vt_norm_map.keys())
common_cols = [sf_norm_map[n] for n in common_norm if n in sf_norm_map and n in vt_norm_map]